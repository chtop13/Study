# 14. ì ì§„ì ì¸ ê°œì„ .

- ì´ ì¥ì€ ì ì§„ì ì¸ ê°œì„ ì„ ë³´ì—¬ì£¼ëŠ” ì‚¬ë¡€ ì—°êµ¬ë‹¤. 
  - ìš°ì„ , ì¶œë°œì€ ì¢‹ì•˜ìœ¼ë‚˜ í™•ì¥ì„±ì´ ë¶€ì¡±í–ˆë˜ ëª¨ë“ˆì„ ì†Œê°œí•œë‹¤. 
  - ë‹¤ìŒ, ëª¨ë“ˆì„ ê°œì„ í•˜ê³  ì •ë¦¬í•˜ëŠ” ë‹¨ê³„ë¥¼ ì‚´í´ë³¸ë‹¤. 

- í”„ë¡œê·¸ë¨ì„ ì§œë‹¤ ë³´ë©´ ì¢…ì¢… ëª…ë ¹í–‰ ì¸ìˆ˜ì˜ êµ¬ë¬¸ì„ ë¶„ì„í•  í•„ìš”ê°€ ìƒê¸´ë‹¤. 
  - í¸ë¦¬í•œ ìœ í‹¸ë¦¬í‹°ê°€ ì—†ë‹¤ë©´ main í•¨ìˆ˜ë¡œ ë„˜ì–´ì˜¤ëŠ” ë¬¸ìì—´ ë°°ì—´ì„ ì§ì ‘ ë¶„ì„í•˜ê²Œ ëœë‹¤. 
  - ì—¬ëŸ¬ ê°€ì§€ í›Œë¥­í•œ ìœ í‹¸ë¦¬í‹°ê°€ ìˆì§€ë§Œ ë‚´ ì‚¬ì •ì— ë”± ë§ëŠ” ìœ í‹¸ë¦¬í‹°ê°€ ì—†ë‹¤ë©´? ë¬¼ë¡  ì§ì ‘ ì§œê² ë‹¤ê³  ê²°ì‹¬í•œë‹¤. 
 
- ìƒˆë¡œ ì§  ìœ í‹¸ë¦¬í‹°ë¥¼ Argsë¼ ë¶€ë¥´ê² ë‹¤. ArgsëŠ” ì‚¬ìš©ë²•ì´ ê°„ë‹¨í•˜ë‹¤. 
  - Args ìƒì„±ìì— (ì…ë ¥ìœ¼ë¡œ ë“¤ì–´ì˜¨) ì¸ìˆ˜ ë¬¸ìì—´ê³¼ í˜•ì‹ ë¬¸ìì—´ì„ ë„˜ê²¨ Args ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•œ í›„ Args ì¸ìŠ¤í„´ìŠ¤ì—ë‹¤ ì¸ìˆ˜ ê°’ì„ ì§ˆì˜í•œë‹¤.
 

  ```java
  - ê°„ë‹¨í•œ Args ì‚¬ìš©ë²•

  public static void main(String[] args) {
    try {
      Args arg = new Args("l,p#,d*", args);
      boolean logging = arg.getBoolean('l');
      int port = arg.getInt('p');
      String directory = arg.getString('d');
      executeApplication(logging, port, directory);
    } catch (ArgsException e) {
      System.out.print("Argument error: %s\n", e.errorMessage());
    }
  }
  ```
- ë§¤ê°œë³€ìˆ˜ ë‘ ê°œë¡œ Args í´ë˜ìŠ¤ì˜ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“ ë‹¤. 
  - ì²«ì§¸ ë§¤ê°œë³€ìˆ˜ëŠ” í˜•ì‹ ë˜ëŠ” ìŠ¤í‚¤ë§ˆë¥¼ ì§€ì •í•œë‹¤. "l,p#,d*"ì€ ëª…ë ¹í–‰ ì¸ìˆ˜ ì„¸ ê°œë¥¼ ì •ì˜í•œë‹¤.
    - ì²« ë²ˆì§¸ -lì€ ë¶€ìš¸ ì¸ìˆ˜ë‹¤. 
    - ë‘ ë²ˆì§¸ -pëŠ” ì •ìˆ˜ ì¸ìˆ˜ë‹¤. 
    - ì„¸ ë²ˆì§¸ -dëŠ” ë¬¸ìì—´ ì¸ìˆ˜ë‹¤. 
  - ë‘ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ëŠ” mainìœ¼ë¡œ ë„˜ì–´ì˜¨ ëª…ë ¹í–‰ ì¸ìˆ˜ ë°°ì—´ ìì²´ë‹¤.

 - ArgsExceptionì´ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ëª…ë ¹í–‰ ì¸ìˆ˜ì˜ êµ¬ë¬¸ì„ ì„±ê³µì ìœ¼ë¡œ ë¶„ì„í–ˆìœ¼ë©° Args ì¸ìŠ¤í„´ìŠ¤ì— ì§ˆì˜ë¥¼ ë˜ì ¸ë„ ì¢‹ë‹¤ëŠ” ë§ì´ë‹¤.
  - ì¸ìˆ˜ ê°’ì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ getBoolean, getInteger, getString ë“±ì˜ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤. 
  - í˜•ì‹ ë¬¸ìì—´ì´ë‚˜ ì¸ìˆ˜ì— ë¬¸ì œê°€ ìˆë‹¤ë©´ ArgsException ì˜ˆì™¸ê°€ ë°œìƒí•˜ê³  ì˜ˆì™¸ê°€ ì œê³µí•˜ëŠ” errorMessage ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤. 

## Args êµ¬í˜„

- ëª©ë¡ 14-2ëŠ” Args í´ë˜ìŠ¤ë‹¤. ì•„ì£¼ ì£¼ì˜ ê¹Šê²Œ ì½ì–´ë³´ê¸° ë°”ë€ë‹¤. ìŠ¤íƒ€ì¼ê³¼ êµ¬ì¡°ì— ì‹ ê²½ì„ ì¼ìœ¼ë¯€ë¡œ í‰ë‚´ ë‚¼ ê°€ì¹˜ê°€ ìˆë‹¤ê³  ë¯¿ëŠ”ë‹¤. 

```java
- ëª©ë¡ 14-2 Args.java

package com.objectmentor.utilities.args;

import static com.objectmentor.utilities.args.ArgsException.ErrorCode.*; 
import java.util.*;

public class Args {
  private Map<Character, ArgumentMarshaler> marshalers;
  private Set<Character> argsFound;
  private ListIterator<String> currentArgument;
  
  public Args(String schema, String[] args) throws ArgsException { 
    marshalers = new HashMap<Character, ArgumentMarshaler>(); 
    argsFound = new HashSet<Character>();
    
    parseSchema(schema);
    parseArgumentStrings(Arrays.asList(args)); 
  }
  
  private void parseSchema(String schema) throws ArgsException { 
    for (String element : schema.split(","))
      if (element.length() > 0) 
        parseSchemaElement(element.trim());
  }
  
  private void parseSchemaElement(String element) throws ArgsException { 
    char elementId = element.charAt(0);
    String elementTail = element.substring(1); 
    validateSchemaElementId(elementId);
    if (elementTail.length() == 0)
      marshalers.put(elementId, new BooleanArgumentMarshaler());
    else if (elementTail.equals("*")) 
      marshalers.put(elementId, new StringArgumentMarshaler());
    else if (elementTail.equals("#"))
      marshalers.put(elementId, new IntegerArgumentMarshaler());
    else if (elementTail.equals("##")) 
      marshalers.put(elementId, new DoubleArgumentMarshaler());
    else if (elementTail.equals("[*]"))
      marshalers.put(elementId, new StringArrayArgumentMarshaler());
    else
      throw new ArgsException(INVALID_ARGUMENT_FORMAT, elementId, elementTail);
  }
  
  private void validateSchemaElementId(char elementId) throws ArgsException { 
    if (!Character.isLetter(elementId))
      throw new ArgsException(INVALID_ARGUMENT_NAME, elementId, null); 
  }
  
  private void parseArgumentStrings(List<String> argsList) throws ArgsException {
    for (currentArgument = argsList.listIterator(); currentArgument.hasNext();) {
      String argString = currentArgument.next(); 
      if (argString.startsWith("-")) {
        parseArgumentCharacters(argString.substring(1)); 
      } else {
        currentArgument.previous();
        break; 
      }
    } 
  }
  
  private void parseArgumentCharacters(String argChars) throws ArgsException { 
    for (int i = 0; i < argChars.length(); i++)
      parseArgumentCharacter(argChars.charAt(i)); 
  }
  
  private void parseArgumentCharacter(char argChar) throws ArgsException { 
    ArgumentMarshaler m = marshalers.get(argChar);
    if (m == null) {
      throw new ArgsException(UNEXPECTED_ARGUMENT, argChar, null); 
    } else {
      argsFound.add(argChar); 
      try {
        m.set(currentArgument); 
      } catch (ArgsException e) {
        e.setErrorArgumentId(argChar);
        throw e; 
      }
    } 
  }
  
  public boolean has(char arg) { 
    return argsFound.contains(arg);
  }
  
  public int nextArgument() {
    return currentArgument.nextIndex();
  }
  
  public boolean getBoolean(char arg) {
    return BooleanArgumentMarshaler.getValue(marshalers.get(arg));
  }
  
  public String getString(char arg) {
    return StringArgumentMarshaler.getValue(marshalers.get(arg));
  }
  
  public int getInt(char arg) {
    return IntegerArgumentMarshaler.getValue(marshalers.get(arg));
  }
  
  public double getDouble(char arg) {
    return DoubleArgumentMarshaler.getValue(marshalers.get(arg));
  }
  
  public String[] getStringArray(char arg) {
    return StringArrayArgumentMarshaler.getValue(marshalers.get(arg));
  } 
}
```

- ì—¬ê¸°ì €ê¸° ë’¤ì ì¼ í•„ìš” ì—†ì´ ìœ„ì—ì„œ ì•„ë˜ë¡œ ì½”ë“œê°€ ì½íŒë‹¤ëŠ” ì‚¬ì‹¤ì— ì£¼ëª©í•œë‹¤.
- í•œ ê°€ì§€ ë¨¼ì € ì½ì–´ë³¼ ì½”ë“œê°€ ìˆë‹¤ë©´ ArgumentMarshaler ì •ì˜ì¸ë°, ì´ ì½”ë“œëŠ” ì¼ë¶€ëŸ¬ ë¹¼ë†“ì•˜ë‹¤.
  - ì½”ë“œë¥¼ ì£¼ì˜ ê¹Šê²Œ ì½ì—ˆë‹¤ë©´ ArgumentMarshaler ì¸í„°í˜ì´ìŠ¤ê°€ ë¬´ì—‡ì´ë©° íŒŒìƒ í´ë˜ìŠ¤ê°€ ë¬´ìŠ¨ ê¸°ëŠ¥ì„ í•˜ëŠ”ì§€ ì´í•´í•˜ë¦¬ë¼
- ëª©ë¡ 14-3ì—ì„œ 14-6ê¹Œì§€ëŠ” ArgumentMarshaler ì¸í„°í˜ì´ìŠ¤ì™€ íŒŒìƒ í´ë˜ìŠ¤ë‹¤. 

```java
- ëª©ë¡ 14-3 ArgumentMarshaler.java

public interface ArgumentMarshaler {
  void set(Iterator<String> currentArgument) throws ArgsException;
}
```
```java
- ëª©ë¡ 14-4 BooleanArgumentMarshaler.java

public class BooleanArgumentMarshaler implements ArgumentMarshaler { 
  private boolean booleanValue = false;
  
  public void set(Iterator<String> currentArgument) throws ArgsException { 
    booleanValue = true;
  }
  
  public static boolean getValue(ArgumentMarshaler am) {
    if (am != null && am instanceof BooleanArgumentMarshaler)
      return ((BooleanArgumentMarshaler) am).booleanValue; 
    else
      return false; 
  }
}
```
```java
- ëª©ë¡ 14-5 StringArgumentMarshaler.java

import static com.objectmentor.utilities.args.ArgsException.ErrorCode.*;

public class StringArgumentMarshaler implements ArgumentMarshaler { 
  private String stringValue = "";
  
  public void set(Iterator<String> currentArgument) throws ArgsException { 
    try {
      stringValue = currentArgument.next(); 
    } catch (NoSuchElementException e) {
      throw new ArgsException(MISSING_STRING); 
    }
  }
  
  public static String getValue(ArgumentMarshaler am) {
    if (am != null && am instanceof StringArgumentMarshaler)
      return ((StringArgumentMarshaler) am).stringValue; 
    else
      return ""; 
  }
}
```
```java
- ëª©ë¡ 14-6 IntegerArgumentMarshaler.java

import static com.objectmentor.utilities.args.ArgsException.ErrorCode.*;

public class IntegerArgumentMarshaler implements ArgumentMarshaler { 
  private int intValue = 0;
  
  public void set(Iterator<String> currentArgument) throws ArgsException { 
    String parameter = null;
    try {
      parameter = currentArgument.next();
      intValue = Integer.parseInt(parameter);
    } catch (NoSuchElementException e) {
      throw new ArgsException(MISSING_INTEGER);
    } catch (NumberFormatException e) {
      throw new ArgsException(INVALID_INTEGER, parameter); 
    }
  }
  
  public static int getValue(ArgumentMarshaler am) {
    if (am != null && am instanceof IntegerArgumentMarshaler)
      return ((IntegerArgumentMarshaler) am).intValue; 
    else
    return 0; 
  }
}
```

- ë‚˜ë¨¸ì§€ DoubleArgumentMarshalerì™€ StringArrayArgumentMarshalerëŠ” ë‹¤ë¥¸ íŒŒìƒ í´ë˜ìŠ¤ì™€ ë˜‘ê°™ì€ íŒ¨í„´ì´ë¯€ë¡œ ì½”ë“œë¥¼ ìƒëµí•œë‹¤. 

- í•œ ê°€ì§€ê°€ ëˆˆì— ê±°ìŠ¬ë¦´ì§€ ëª¨ë¥´ê² ë‹¤. ë°”ë¡œ ì˜¤ë¥˜ ì½”ë“œ ìƒìˆ˜ë¥¼ ì •ì˜í•˜ëŠ” ë¶€ë¶„ì´ë‹¤. ëª©ë¡ 14-7ì„ ì‚´í´ë³´ì. 
```java
- ëª©ë¡ 14-7 ArgsException.java

import static com.objectmentor.utilities.args.ArgsException.ErrorCode.*;

public class ArgsException extends Exception { 
  private char errorArgumentId = '\0'; 
  private String errorParameter = null; 
  private ErrorCode errorCode = OK;
  
  public ArgsException() {}
  
  public ArgsException(String message) {super(message);}
  
  public ArgsException(ErrorCode errorCode) { 
    this.errorCode = errorCode;
  }
  
  public ArgsException(ErrorCode errorCode, String errorParameter) { 
    this.errorCode = errorCode;
    this.errorParameter = errorParameter;
  }
  
  public ArgsException(ErrorCode errorCode, char errorArgumentId, String errorParameter) {
    this.errorCode = errorCode; 
    this.errorParameter = errorParameter; 
    this.errorArgumentId = errorArgumentId;
  }
  
  public char getErrorArgumentId() { 
    return errorArgumentId;
  }
  
  public void setErrorArgumentId(char errorArgumentId) { 
    this.errorArgumentId = errorArgumentId;
  }
  
  public String getErrorParameter() { 
    return errorParameter;
  }
  
  public void setErrorParameter(String errorParameter) { 
    this.errorParameter = errorParameter;
  }
  
  public ErrorCode getErrorCode() { 
    return errorCode;
  }
  
  public void setErrorCode(ErrorCode errorCode) { 
    this.errorCode = errorCode;
  }
  
  public String errorMessage() { 
    switch (errorCode) {
      case OK:
        return "TILT: Should not get here.";
      case UNEXPECTED_ARGUMENT:
        return String.format("Argument -%c unexpected.", errorArgumentId);
      case MISSING_STRING:
        return String.format("Could not find string parameter for -%c.", errorArgumentId);
      case INVALID_INTEGER:
        return String.format("Argument -%c expects an integer but was '%s'.", errorArgumentId, errorParameter);
      case MISSING_INTEGER:
        return String.format("Could not find integer parameter for -%c.", errorArgumentId);
      case INVALID_DOUBLE:
        return String.format("Argument -%c expects a double but was '%s'.", errorArgumentId, errorParameter);
      case MISSING_DOUBLE:
        return String.format("Could not find double parameter for -%c.", errorArgumentId); 
      case INVALID_ARGUMENT_NAME:
        return String.format("'%c' is not a valid argument name.", errorArgumentId);
      case INVALID_ARGUMENT_FORMAT:
        return String.format("'%s' is not a valid argument format.", errorParameter);
    }
    return ""; 
  }
  
  public enum ErrorCode {
    OK, INVALID_ARGUMENT_FORMAT, UNEXPECTED_ARGUMENT, INVALID_ARGUMENT_NAME, 
    MISSING_STRING, MISSING_INTEGER, INVALID_INTEGER, MISSING_DOUBLE, INVALID_DOUBLE
  }
}
```

- ì´ì²˜ëŸ¼ ë‹¨ìˆœí•œ ê°œë…ì„ êµ¬í˜„í•˜ëŠ”ë° ì½”ë“œê°€ ë„ˆë¬´ ë§ì´ í•„ìš”í•´ ë†€ë„ì§€ë„ ëª¨ë¥´ê² ë‹¤.
- ìš°ì„ ì ì¸ ì´ìœ ëŠ” ì¥í™©í•œ ì–¸ì–´ì¸ ìë°”ë¥¼ ì‚¬ìš©í•´ì„œì¸ë°, ì •ì  íƒ€ì… ì–¸ì–´ë¼ì„œ íƒ€ì… ì‹œìŠ¤í…œì„ ë§Œì¡±í•˜ë ¤ë©´ ë§ì€ ë‹¨ì–´ê°€ í•„ìš”í•˜ë‹¤. 

- í•˜ì§€ë§Œ ì´ë¦„ì„ ë¶™ì¸ ë°©ë²•, í•¨ìˆ˜ í¬ê¸°, ì½”ë“œ í˜•ì‹ì— ì£¼ëª©í•œë‹¤.
  - ë…¸ë ¨í•œ í”„ë¡œê·¸ë˜ë¨¸ë¼ë©´ ì—¬ê¸°ì €ê¸° ìì˜í•œ êµ¬ì¡°ë‚˜ ìŠ¤íƒ€ì¼ì´ ê±°ìŠ¬ë¦´ì§€ ëª¨ë¥´ê² ì§€ë§Œ ì „ë°˜ì ìœ¼ë¡œ ê¹”ë”í•œ êµ¬ì¡°ì— ì˜ ì§œì¸ í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì—¬ê²¨ì£¼ë©´ ì¢‹ê² ë‹¤. 

- ì˜ˆë¥¼ ë“¤ì–´, ë‚ ì§œ ì¸ìˆ˜ë‚˜ ë³µì†Œìˆ˜ ì¸ìˆ˜ ë“± ìƒˆë¡œìš´ ì¸ìˆ˜ ìœ í˜•ì„ ì¶”ê°€í•˜ëŠ” ë°©ë²•ì´ ëª…ë°±í•˜ë‹¤.
  - ê³ ì¹  ì½”ë“œë„ ë³„ë¡œ ì—†ë‹¤. ê°„ë‹¨íˆ ì„¤ëª…í•˜ìë©´, ArgumentMarshalerì—ì„œ ìƒˆ í´ë˜ìŠ¤ë¥¼ íŒŒìƒí•´ getXXX í•¨ìˆ˜ë¥¼ ì¶”ê°€í•œ í›„ parseSchemaElement í•¨ìˆ˜ì— ìƒˆ case ë¬¸ë§Œ ì¶”ê°€í•˜ë©´ ëì´ë‹¤. 
  - í•„ìš”í•˜ë‹¤ë©´ ìƒˆ ArgsException.ErrorCodeë¥¼ ë§Œë“¤ê³  ìƒˆ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•œë‹¤. 

### ì–´ë–»ê²Œ ì§°ëŠëƒê³ ?

- ì¼ë‹¨ ì§„ì •í•˜ê¸° ë°”ë€ë‹¤?. ë‚˜ëŠ” ìœ„ í”„ë¡œê·¸ë¨ì„ ì²˜ìŒë¶€í„° ì €ë ‡ê²Œ êµ¬í˜„í•˜ì§€ ì•Šì•˜ë‹¤. 
  - ë”ìš± ì¤‘ìš”í•˜ê²ŒëŠ” ì—¬ëŸ¬ë¶„ì´ ê¹¨ë—í•˜ê³  ìš°ì•„í•œ í”„ë¡œê·¸ë¨ì„ í•œ ë°©ì— ëšë”± ë‚´ë†“ìœ¼ë¦¬ë¼ ê¸°ëŒ€í•˜ì§€ ì•ŠëŠ”ë‹¤.
  - ì§€ë‚œ ìˆ˜ì‹­ì—¬ ë…„ ë™ì•ˆ ìŒ“ì•„ì˜¨ ê²½í—˜ì—ì„œ ì–»ì€ êµí›ˆì´ë¼ë©´, `í”„ë¡œê·¸ë˜ë°ì€ ê³¼í•™ë³´ë‹¤ ê³µì˜ˆ(craft)ì— ê°€ê¹ë‹¤ëŠ” ì‚¬ì‹¤ì´ë‹¤. ê¹¨ë—í•œ ì½”ë“œë¥¼ ì§œë ¤ë©´ ë¨¼ì € ì§€ì €ë¶„í•œ ì½”ë“œë¥¼ ì§  ë’¤ì— ì •ë¦¬í•´ì•¼ í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.`  

- ì²˜ìŒ ë“£ëŠ” ì´ì•¼ê¸°ê°€ ì•„ë‹ˆë¼ê³  ìƒê°í•œë‹¤. 
  - ì´ˆë“±í•™êµ ì‹œì ˆ ì„ ìƒë‹˜ë“¤ë„ ì‘ë¬¸ì„ í•  ë•Œë„ ì´ˆì•ˆë¶€í„° ì“°ë¼ê³  êµìœ¡ì„ í•˜ì…¨ë‹¤. 
  - ê¹”ë”í•œ ì‘í’ˆì„ ë‚´ë†“ìœ¼ë ¤ë©´ ë‹¨ê³„ì ìœ¼ë¡œ ê°œì„ í•´ì•¼ í•œë‹¤ê³  ê°€ë¥´ì¹˜ë ¤ ì• ì“°ì…¨ë‹¤.

- ëŒ€ë‹¤ìˆ˜ì˜ ì‹ ì°¸ í”„ë¡œê·¸ë˜ë¨¸ëŠ” (ëŒ€ë‹¤ìˆ˜ ì´ˆë”©ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ) ì´ ì¶©ê³ ë¥¼ ì¶©ì‹¤íˆ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. 
  - ê·¸ë“¤ì€ ë¬´ì¡°ê±´ ëŒì•„ê°€ëŠ” í”„ë¡œê·¸ë¨ì„ ëª©í‘œë¡œ ì¡ëŠ”ë‹¤. 
  - ì¼ë‹¨ í”„ë¡œê·¸ë¨ì´ 'ëŒì•„ê°€ë©´' ë‹¤ìŒ ì—…ë¬´ë¡œ ë„˜ì–´ê°„ë‹¤. 
  - 'ëŒì•„ê°€ëŠ”' í”„ë¡œê·¸ë¨ì€ ê·¸ ìƒíƒœê°€ ì–´ë–»ë“  ê·¸ëŒ€ë¡œ ë²„ë ¤ë‘”ë‹¤. 
  - `ê²½í—˜ì´ í’ë¶€í•œ ì „ë¬¸ í”„ë¡œê·¸ë˜ë¨¸ë¼ë©´ ì´ëŸ° í–‰ë™ì´ ì „ë¬¸ê°€ë¡œì„œ ìì‚´ í–‰ìœ„ë¼ëŠ” ì‚¬ì‹¤ì„ ì˜ ì•ˆë‹¤.`

## Args: 1ì°¨ ì´ˆì•ˆ
- ëª©ë¡ 14-8ì€ ë‚´ê°€ ë§¨ ì²˜ìŒ ì§°ë˜ Args í´ë˜ìŠ¤ë‹¤. ì½”ë“œëŠ” 'ëŒì•„ê°€ì§€ë§Œ' ì—‰ë§ì´ë‹¤.
```java
- ëª©ë¡ 14-8 Args.java(1ì°¨ ì´ˆì•ˆ)

import java.text.ParseException; 
import java.util.*;

public class Args {
  private String schema;
  private String[] args;
  private boolean valid = true;
  private Set<Character> unexpectedArguments = new TreeSet<Character>(); 
  private Map<Character, Boolean> booleanArgs = new HashMap<Character, Boolean>();
  private Map<Character, String> stringArgs = new HashMap<Character, String>(); 
  private Map<Character, Integer> intArgs = new HashMap<Character, Integer>(); 
  private Set<Character> argsFound = new HashSet<Character>();
  private int currentArgument;
  private char errorArgumentId = '\0';
  private String errorParameter = "TILT";
  private ErrorCode errorCode = ErrorCode.OK;
  
  private enum ErrorCode {
    OK, MISSING_STRING, MISSING_INTEGER, INVALID_INTEGER, UNEXPECTED_ARGUMENT}
    
  public Args(String schema, String[] args) throws ParseException { 
    this.schema = schema;
    this.args = args;
    valid = parse();
  }
  
  private boolean parse() throws ParseException { 
    if (schema.length() == 0 && args.length == 0)
      return true; 
    parseSchema(); 
    try {
      parseArguments();
    } catch (ArgsException e) {
    }
    return valid;
  }
  
  private boolean parseSchema() throws ParseException { 
    for (String element : schema.split(",")) {
      if (element.length() > 0) {
        String trimmedElement = element.trim(); 
        parseSchemaElement(trimmedElement);
      } 
    }
    return true; 
  }
  
  private void parseSchemaElement(String element) throws ParseException { 
    char elementId = element.charAt(0);
    String elementTail = element.substring(1); 
    validateSchemaElementId(elementId);
    if (isBooleanSchemaElement(elementTail)) 
      parseBooleanSchemaElement(elementId);
    else if (isStringSchemaElement(elementTail)) 
      parseStringSchemaElement(elementId);
    else if (isIntegerSchemaElement(elementTail)) 
      parseIntegerSchemaElement(elementId);
    else
      throw new ParseException(String.format("Argument: %c has invalid format: %s.", 
        elementId, elementTail), 0);
    } 
  }
    
  private void validateSchemaElementId(char elementId) throws ParseException { 
    if (!Character.isLetter(elementId)) {
      throw new ParseException("Bad character:" + elementId + "in Args format: " + schema, 0);
    }
  }
  
  private void parseBooleanSchemaElement(char elementId) { 
    booleanArgs.put(elementId, false);
  }
  
  private void parseIntegerSchemaElement(char elementId) { 
    intArgs.put(elementId, 0);
  }
  
  private void parseStringSchemaElement(char elementId) { 
    stringArgs.put(elementId, "");
  }
  
  private boolean isStringSchemaElement(String elementTail) { 
    return elementTail.equals("*");
  }
  
  private boolean isBooleanSchemaElement(String elementTail) { 
    return elementTail.length() == 0;
  }
  
  private boolean isIntegerSchemaElement(String elementTail) { 
    return elementTail.equals("#");
  }
  
  private boolean parseArguments() throws ArgsException {
    for (currentArgument = 0; currentArgument < args.length; currentArgument++) {
      String arg = args[currentArgument];
      parseArgument(arg); 
    }
    return true; 
  }
  
  private void parseArgument(String arg) throws ArgsException { 
    if (arg.startsWith("-"))
      parseElements(arg); 
  }
  
  private void parseElements(String arg) throws ArgsException { 
    for (int i = 1; i < arg.length(); i++)
      parseElement(arg.charAt(i)); 
  }
  
  private void parseElement(char argChar) throws ArgsException { 
    if (setArgument(argChar))
      argsFound.add(argChar); 
    else 
      unexpectedArguments.add(argChar); 
      errorCode = ErrorCode.UNEXPECTED_ARGUMENT; 
      valid = false;
  }
  
  private boolean setArgument(char argChar) throws ArgsException { 
    if (isBooleanArg(argChar))
      setBooleanArg(argChar, true); 
    else if (isStringArg(argChar))
      setStringArg(argChar); 
    else if (isIntArg(argChar))
      setIntArg(argChar); 
    else
      return false;
    
    return true; 
  }
  
  private boolean isIntArg(char argChar) {
    return intArgs.containsKey(argChar);
  }
  
  private void setIntArg(char argChar) throws ArgsException { 
    currentArgument++;
    String parameter = null;
    try {
      parameter = args[currentArgument];
      intArgs.put(argChar, new Integer(parameter)); 
    } catch (ArrayIndexOutOfBoundsException e) {
      valid = false;
      errorArgumentId = argChar;
      errorCode = ErrorCode.MISSING_INTEGER;
      throw new ArgsException();
    } catch (NumberFormatException e) {
      valid = false;
      errorArgumentId = argChar; 
      errorParameter = parameter;
      errorCode = ErrorCode.INVALID_INTEGER; 
      throw new ArgsException();
    } 
  }
  
  private void setStringArg(char argChar) throws ArgsException { 
    currentArgument++;
    try {
      stringArgs.put(argChar, args[currentArgument]); 
    } catch (ArrayIndexOutOfBoundsException e) {
      valid = false;
      errorArgumentId = argChar;
      errorCode = ErrorCode.MISSING_STRING; 
      throw new ArgsException();
    } 
  }
  
  private boolean isStringArg(char argChar) { 
    return stringArgs.containsKey(argChar);
  }
  
  private void setBooleanArg(char argChar, boolean value) { 
    booleanArgs.put(argChar, value);
  }
  
  private boolean isBooleanArg(char argChar) { 
    return booleanArgs.containsKey(argChar);
  }
  
  public int cardinality() { 
    return argsFound.size();
  }
  
  public String usage() { 
    if (schema.length() > 0)
      return "-[" + schema + "]"; 
    else
      return ""; 
  }
  
  public String errorMessage() throws Exception { 
    switch (errorCode) {
      case OK:
        throw new Exception("TILT: Should not get here.");
      case UNEXPECTED_ARGUMENT:
        return unexpectedArgumentMessage();
      case MISSING_STRING:
        return String.format("Could not find string parameter for -%c.", errorArgumentId);
      case INVALID_INTEGER:
        return String.format("Argument -%c expects an integer but was '%s'.", errorArgumentId, errorParameter);
      case MISSING_INTEGER:
        return String.format("Could not find integer parameter for -%c.", errorArgumentId);
    }
    return ""; 
  }
  
  private String unexpectedArgumentMessage() {
    StringBuffer message = new StringBuffer("Argument(s) -"); 
    for (char c : unexpectedArguments) {
      message.append(c); 
    }
    message.append(" unexpected.");
    
    return message.toString(); 
  }
  
  private boolean falseIfNull(Boolean b) { 
    return b != null && b;
  }
  
  private int zeroIfNull(Integer i) { 
    return i == null ? 0 : i;
  }
  
  private String blankIfNull(String s) { 
    return s == null ? "" : s;
  }
  
  public String getString(char arg) { 
    return blankIfNull(stringArgs.get(arg));
  }
  
  public int getInt(char arg) {
    return zeroIfNull(intArgs.get(arg));
  }
  
  public boolean getBoolean(char arg) { 
    return falseIfNull(booleanArgs.get(arg));
  }
  
  public boolean has(char arg) { 
    return argsFound.contains(arg);
  }
  
  public boolean isValid() { 
    return valid;
  }
  
  private class ArgsException extends Exception {
  } 
}
```

- ì´ì²˜ëŸ¼ ì§€ì €ë¶„í•œ ì½”ë“œë¥¼ ë³´ê³  ì²˜ìŒ ë“  ìƒê°ì´ "ì €ìê°€ ê·¸ëƒ¥ ë²„ë ¤ë‘ì§€ ì•Šì•„ì„œ ì§„ì§œ ë‹¤í–‰ì´ì•¼!"ì´ê¸° ë°”ë€ë‹¤.   
  - ë§Œì•½ ê·¸ë ‡ë‹¤ë©´ ê·¸ë ‡ë‹¤ë©´ ìì‹ ì´ ëŒ€ì¶© ì§œì„œ ë‚¨ê²¨ë‘” ì½”ë“œë¥¼ ë‚¨ë“¤ì´ ì–´ë–»ê²Œ ëŠë‚„ì§€ ìƒê°í•˜ê¸° ë°”ë€ë‹¤. 

- ì‚¬ì‹¤ '1ì°¨ ì´ˆì•ˆ'ì€ ë‚¯ ëœ¨ê±°ìš´ í‘œí˜„ì´ë‹¤. 
  - ëª©ë¡ 14-8ì€ ëª…ë°±íˆ ë¯¸ì™„ì„±ì´ë‹¤. 
  - ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ê°œìˆ˜ë§Œë„ ì••ë„ì ì´ê³  'TILT' ì™€ ê°™ì€ í¬í•œí•œ ë¬¸ìì—´, HashSets, TreeSets, try-catch-catch ë¸”ë¡ ë“± ëª¨ë‘ê°€ ì§€ì €ë¶„í•œ ì½”ë“œì— ê¸°ì—¬í•˜ëŠ” ìš”ì¸ì´ë‹¤. 

- ì²˜ìŒë¶€í„° ì§€ì €ë¶„í•œ ì½”ë“œë¥¼ ì§œë ¤ëŠ” ìƒê°ì€ ì—†ì—ˆë‹¤. 
  - ì‹¤ì œë¡œë„ ì½”ë“œë¥¼ ì–´ëŠ ì •ë„ ì†ë³´ë ¤ê³  ì• ì¼ë‹¤. í•¨ìˆ˜ ì´ë¦„ì´ë‚˜ ë³€ìˆ˜ ì´ë¦„ì„ ì„ íƒí•œ ë°©ì‹, ì–´ì„¤í”„ì§€ë§Œ ë‚˜ë¦„ëŒ€ë¡œ êµ¬ì¡°ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ ë“±ì´ ë‚´ ë…¸ë ¥ì˜ ì¦ê±°ë‹¤. í•˜ì§€ë§Œ ì–´ëŠ ìˆœê°„ í”„ë¡œê·¸ë¨ì€ ë‚´ ì†ì„ ë²—ì–´ë‚¬ë‹¤. 
  
- ì²« ë²„ì „ì´ë˜ Boolean ì¸ìˆ˜ë§Œ ì§€ì›í•˜ë˜ ì´ˆê¸° ë²„ì „ì—ì„œ Stringê³¼ Integer ì¸ìˆ˜ ìœ í˜•ì„ ì¶”ê°€í•˜ë©´ì„œ ë¶€í„° ì¬ì•™ì´ ì‹œì‘ëë‹¤. 

ì£¼) ê´€ë ¨ ì½”ë“œë“¤ ì—­ì‹œ ìˆì§€ë§Œ ë‚´ìš©ì´ ë„ˆë¬´ ë§ê¸°ì— ë‚´ìš© ë° ì½”ë“œë¥¼ ìƒëµ


### ê·¸ë˜ì„œ ë©ˆì·„ë‹¤

- ì¶”ê°€í•  ì¸ìˆ˜ ìœ í˜•ì´ ì ì–´ë„ ë‘ ê°œëŠ” ë” ìˆì—ˆëŠ”ë° ê·¸ëŸ¬ë©´ ì½”ë“œê°€ í›¨ì”¬ ë” ë‚˜ë¹ ì§€ë¦¬ë¼ëŠ” ì‚¬ì‹¤ì´ ìëª…í–ˆë‹¤.   
  - ê³„ì† ë°€ì–´ë¶™ì´ë©´ í”„ë¡œê·¸ë¨ì€ ì–´ë–»ê²Œë“  ì™„ì„±í•˜ê² ì§€ë§Œ ê·¸ë¬ë‹¤ê°€ëŠ” ë„ˆë¬´ ì»¤ì„œ ì†ëŒ€ê¸° ì–´ë ¤ìš´ ê³¨ì¹«ê±°ë¦¬ê°€ ìƒê²¨ë‚  ì°¸ì´ì—ˆë‹¤. 
  - ì½”ë“œ êµ¬ì¡°ë¥¼ ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì¢‹ì€ ìƒíƒœë¡œ ë§Œë“¤ë ¤ë©´ ì§€ê¸ˆì´ ì ê¸°ë¼ íŒë‹¨í–ˆë‹¤. 

- ê·¸ë˜ì„œ ë‚˜ëŠ” ê¸°ëŠ¥ì„ ë” ì´ìƒ ì¶”ê°€í•˜ì§€ ì•Šê¸°ë¡œ ê²°ì •í•˜ê³  ë¦¬íŒ©í„°ë§ì„ ì‹œì‘í–ˆë‹¤.
  -  String, Integer ìœ í˜•ì„ ì¶”ê°€í•œ ê²½í—˜ì—ì„œ ë‚˜ëŠ” ìƒˆ ì¸ìˆ˜ ìœ í˜•ì„ ì¶”ê°€í•˜ë ¤ë©´ ì£¼ìš” ì§€ì  ì„¸ ê³³ì—ë„ ì½”ë“œë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì´ë¯¸ ê¹¨ë‹¬ì•˜ë‹¤. 

- ì¸ìˆ˜ ìœ í˜•ì€ ë‹¤ì–‘í•˜ì§€ë§Œ ëª¨ë‘ê°€ ìœ ì‚¬í•œ ë©”ì„œë“œë¥¼ ì œê³µí•˜ë¯€ë¡œ í´ë˜ìŠ¤ í•˜ë‚˜ê°€ ì í•©í•˜ë‹¤ íŒë‹¨í–ˆë‹¤. ê·¸ë˜ì„œ ArgumentMarshalerë¼ëŠ” ê°œë…ì´ íƒ„ìƒí–ˆë‹¤. 

### ì ì§„ì ìœ¼ë¡œ ê°œì„ í•˜ë‹¤

- í”„ë¡œê·¸ë¨ì„ ë§ì¹˜ëŠ” ê°€ì¥ ì¢‹ì€ ë°©ë²• ì¤‘ í•˜ë‚˜ëŠ” ê°œì„ ì´ë¼ëŠ” ì´ë¦„ ì•„ë˜ êµ¬ì¡°ë¥¼ í¬ê²Œ ë’¤ì§‘ëŠ” í–‰ìœ„ë‹¤. 
  - ì–´ë–¤ í”„ë¡œê·¸ë¨ì€ ê·¸ì € ê·¸ëŸ° 'ê°œì„ 'ì—ì„œ ê²°ì½” íšŒë³µí•˜ì§€ ëª»í•œë‹¤. 
  - 'ê°œì„ ' ì „ê³¼ ë˜‘ê°™ì´ í”„ë¡œê·¸ë¨ì„ ëŒë¦¬ê¸°ê°€ ì•„ì£¼ ì–´ë µê¸° ë•Œë¬¸ì´ë‹¤. 

- `ê·¸ë˜ì„œ ë‚˜ëŠ” í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ(Test-Driven Development, TDD)ë¼ëŠ” ê¸°ë²•ì„ ì‚¬ìš©í–ˆë‹¤.`
  - TDDëŠ” ì–¸ì œ ì–´ëŠ ë•Œë¼ë„ ì‹œìŠ¤í…œì´ ëŒì•„ê°€ì•¼ í•œë‹¤ëŠ” ì›ì¹™ì„ ë”°ë¥¸ë‹¤. 
  - ë‹¤ì‹œ ë§í•´, TDDëŠ” ì‹œìŠ¤í…œì„ ë§ê°€ëœ¨ë¦¬ëŠ” ë³€ê²½ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. 
  - ë³€ê²½ì„ ê°€í•œ í›„ì—ë„ ì‹œìŠ¤í…œì´ ë³€ê²½ ì „ê³¼ ë˜‘ê°™ì´ ëŒì•„ê°€ì•¼ í•œë‹¤ëŠ” ë§ì´ë‹¤. 

- ë³€ê²½ ì „í›„ ì‹œìŠ¤í…œì´ ë˜‘ê°™ì´ ëŒì•„ê°„ë‹¤ëŠ” ì‚¬ì‹¤ì„ í™•ì¸í•˜ë ¤ë©´ ì–¸ì œë“  ì‹¤í–‰ì´ ê°€ëŠ¥í•œ ìë™í™”ëœ í…ŒìŠ¤íŠ¸ ìŠˆíŠ¸ê°€ í•„ìš”í•˜ë‹¤. 
  - ì•ì„œ Args í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ë™ì•ˆì— ë‚˜ëŠ” ì´ë¯¸ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìŠˆíŠ¸ì™€ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ ë†“ì•˜ë‹¤.
  - ë‘ í…ŒìŠ¤íŠ¸ ëª¨ë‘ ì–¸ì œë“  ì‹¤í–‰ì´ ê°€ëŠ¥í–ˆê³ , ì‹œìŠ¤í…œì´ ë‘ í…ŒìŠ¤íŠ¸ë¥¼ ëª¨ë‘ í†µê³¼í•˜ë©´ ì˜¬ë°”ë¡œ ë™ì‘í•œë‹¤ê³  ë´ë„ ì¢‹ì•˜ë‹¤. 

- ê·¸ë˜ì„œ ë‚˜ëŠ” ì‹œìŠ¤í…œì— ìì˜í•œ ë³€ê²½ì„ ê°€í•˜ê¸° ì‹œì‘í–ˆë‹¤. 
  - ì½”ë“œë¥¼ ë³€ê²½í•  ë•Œë§ˆë‹¤ ì‹œìŠ¤í…œ êµ¬ì¡°ëŠ” ì¡°ê¸ˆì”© ArgumentMarshaler ê°œë…ì— ê°€ê¹Œì›Œì¡Œë‹¤. 
  - ë˜í•œ ë³€ê²½ í›„ì—ë„ ì‹œìŠ¤í…œì€ ì—¬ì „íˆ ì˜ ëŒì•„ê°”ë‹¤. 
  - ê°€ì¥ ë¨¼ì € ë‚˜ëŠ” ê¸°ì¡´ ì½”ë“œ ëì— ArgumentMarshaler í´ë˜ìŠ¤ì˜ ê³¨ê²©ì„ ì¶”ê°€í–ˆë‹¤. 
  
```java
- ëª©ë¡ 14-11 Args.java ëì— ì¶”ê°€í•œ ArgumentMarshaler

private class ArgumentMarshaler { 
  private boolean booleanValue = false;

  public void setBoolean(boolean value) { 
    booleanValue = value;
  }
  
  public boolean getBoolean() {return booleanValue;} 
}

private class BooleanArgumentMarshaler extends ArgumentMarshaler { }
private class StringArgumentMarshaler extends ArgumentMarshaler { }
private class IntegerArgumentMarshaler extends ArgumentMarshaler { }
```

- ê·¸ë¦¬ê³  ì½”ë“œë¥¼ ìµœì†Œë¡œ ê±´ë“œë¦¬ëŠ”, ê°€ì¥ ë‹¨ìˆœí•œ ë³€ê²½ì„ ê°€í–ˆë‹¤. 
  - êµ¬ì²´ì ìœ¼ë¡œëŠ” Boolean ì¸ìˆ˜ë¥¼ ì €ì¥í•˜ëŠ” HashMapì—ì„œ Boolean ì¸ìˆ˜ ìœ í˜•ì„ ArgumentMarshaler ìœ í˜•ìœ¼ë¡œ ë°”ê¿¨ë‹¤. 

```java
private Map<Character, ArgumentMarshaler> boolean Args = new HashMap<Character, ArgumentMarshaler>();
```

- ê·¸ëŸ¬ë©´ ì½”ë“œ ì¼ë¶€ê°€ ê¹¨ì§€ê¸°ì— ê³ ì³ì¤€ë‹¤, Null ì²´í¬ í•˜ëŠ” ì½”ë“œë„ ìˆ˜ì •í•´ ì¤€ë‹¤. 

```java
...
private void parseBooleanSchemaElement(char elementId) {
  booleanArgs.put(elementId, new BooleanArgumentMarshaler());
}
..
private void setBooleanArg(char argChar, boolean value) {
  booleanArgs.get(argChar).setBoolean(value);
}
...
public boolean getBoolean(char arg) {
  Args.ArgumentMarshaler am = booleanArgs.get(arg);
  return am != null && am.getBoolean();
}
```

## String ì¸ìˆ˜
- String ì¸ìˆ˜ë¥¼ ì¶”ê°€í•˜ëŠ” ê³¼ì •ì€ boolean ì¸ìˆ˜ì™€ ë§¤ìš° ìœ ì‚¬í–ˆë‹¤. 
  - HashMapì„ ë³€ê²½í•œ í›„ parse, set, get í•¨ìˆ˜ë¥¼ ê³ ì³¤ë‹¤. 
  - ì¼ë‹¨ ê° ì¸ìˆ˜ ìœ í˜•ì„ ì²˜ë¦¬í•˜ëŠ” ì½”ë“œë¥¼ `ëª¨ë‘ ArgumentMarshaler í´ë˜ìŠ¤ì— ë„£ê³ ` ë‚˜ì„œ ê·¸ íŒŒìƒ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ ì½”ë“œë¥¼ ë¶„ë¦¬í•  ê³„íšì„ ì„¸ìš°ê³  ì§„í–‰í–ˆë‹¤. 
    - ê·¸ëŸ¬ë©´ í”„ë¡œê·¸ë¨ êµ¬ì¡°ë¥¼ ì¡°ê¸ˆì”© ë³€ê²½í•˜ëŠ” ë™ì•ˆì—ë„ ì‹œìŠ¤í…œì˜ ì •ìƒ ë™ì‘ì„ ìœ ì§€í•˜ê¸° ì‰¬ì›Œì§€ê¸° ë•Œë¬¸ì´ë‹¤.
    - ì½”ë“œ ìƒëµğŸ‘

  - ê·¸ëŸ¬ë©´ í”„ë¡œê·¸ë¨ êµ¬ì¡°ë¥¼ ì¡°ê¸ˆì”© ë³€ê²½í•˜ëŠ” ë™ì•ˆì—ë„ ì‹œìŠ¤í…œì˜ ì •ìƒ ë™ì‘ì„ ìœ ì§€í•˜ê¸° ì‰¬ì›Œì§€ê¸° ë•Œë¬¸ì´ë‹¤. 

- í•´ë‹¹ ë¶€ë¶„ì„ ë¦¬íŒ©í† ë§í•˜ê³  ë‚œ í›„ ë‚¨ëŠ” ë¬¸ì œëŠ” ì˜ˆì™¸ ì½”ë“œ ë¶€ë¶„ì´ë‹¤. 
  - ì˜ˆì™¸ ì½”ë“œëŠ” ì•„ì£¼ í‰í• ë¿ë”ëŸ¬ ì‚¬ì‹¤ìƒ Args í´ë˜ìŠ¤ì— ì†í•˜ì§€ë„ ì•ŠëŠ”ë‹¤.
  - ê²Œë‹¤ê°€ ParseExceptionì„ ë˜ì§€ì§€ë§Œ ParseExceptionì€ Args í´ë˜ìŠ¤ì— ì†í•˜ì§€ ì•ŠëŠ”ë‹¤. 
  - ê·¸ëŸ¬ë¯€ë¡œ ëª¨ë“  ì˜ˆì™¸ë¥¼ í•˜ë‚˜ë¡œ ëª¨ì•„ ArgsException í´ë˜ìŠ¤ë¥¼ ë§Œë“  í›„ ë…ì ëª¨ë“ˆë¡œ ì˜®ê¸´ë‹¤. 
  - ì´ë ‡ê²Œ ë˜ë©´ Args ëª¨ë“ˆì—ì„œ ì˜ˆì™¸/ì˜¤ë¥˜ ì²˜ë¦¬ ì½”ë“œë¥¼ ì™„ë²½í•˜ê²Œ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤. 


```java
- ëª©ë¡ 14-15 ArgsException.java
public class ArgsException extends Exception { 
  private char errorArgumentId = '\0'; 
  private String errorParameter = "TILT"; 
  private ErrorCode errorCode = ErrorCode.OK;
  
  public ArgsException() {}
  
  public ArgsException(String message) {super(message);}
  
  public ArgsException(ErrorCode errorCode) { 
    this.errorCode = errorCode;
  }
  
  public ArgsException(ErrorCode errorCode, String errorParameter) { 
    this.errorCode = errorCode;
    this.errorParameter = errorParameter;
  }
  
  public ArgsException(ErrorCode errorCode, char errorArgumentId, String errorParameter) {
    this.errorCode = errorCode; 
    this.errorParameter = errorParameter; 
    this.errorArgumentId = errorArgumentId;
  }
  
  public char getErrorArgumentId() { 
    return errorArgumentId;
  }
  
  public void setErrorArgumentId(char errorArgumentId) { 
    this.errorArgumentId = errorArgumentId;
  }
  
  public String getErrorParameter() { 
    return errorParameter;
  }
  
  public void setErrorParameter(String errorParameter) {  
    this.errorParameter = errorParameter;
  }
  
  public ErrorCode getErrorCode() { 
    return errorCode;
  }
  
  public void setErrorCode(ErrorCode errorCode) { 
    this.errorCode = errorCode;
  }
  
  public String errorMessage() throws Exception { 
    switch (errorCode) {
      case OK:
        throw new Exception("TILT: Should not get here.");
      case UNEXPECTED_ARGUMENT:
        return String.format("Argument -%c unexpected.", errorArgumentId);
      case MISSING_STRING:
        return String.format("Could not find string parameter for -%c.", errorArgumentId);
      case INVALID_INTEGER:
        return String.format("Argument -%c expects an integer but was '%s'.", errorArgumentId, errorParameter);
      case MISSING_INTEGER:
        return String.format("Could not find integer parameter for -%c.", errorArgumentId);
      case INVALID_DOUBLE:
        return String.format("Argument -%c expects a double but was '%s'.", errorArgumentId, errorParameter);
      case MISSING_DOUBLE:
        return String.format("Could not find double parameter for -%c.", errorArgumentId);
    }
    return ""; 
  }
  
  public enum ErrorCode {
    OK, INVALID_FORMAT, UNEXPECTED_ARGUMENT, INVALID_ARGUMENT_NAME, MISSING_STRING,
    MISSING_INTEGER, INVALID_INTEGER,
    MISSING_DOUBLE, INVALID_DOUBLE
  }
}
```

##### ëª©ë¡ 14-16 Args.java
```java
public class Args {
  private String schema;
  private Map<Character, ArgumentMarshaler> marshalers = new HashMap<Character, ArgumentMarshaler>();
  private Set<Character> argsFound = new HashSet<Character>(); 
  private Iterator<String> currentArgument;
  private List<String> argsList;
  
  public Args(String schema, String[] args) throws ArgsException { 
    this.schema = schema;
    argsList = Arrays.asList(args);
    parse();
  }
  
  private void parse() throws ArgsException { 
    parseSchema();
    parseArguments();
  }
  
  private boolean parseSchema() throws ArgsException {
    for (String element : schema.split(",")) { 
      if (element.length() > 0) {
        parseSchemaElement(element.trim()); 
      }
    }
    return true; 
  }
  
  private void parseSchemaElement(String element) throws ArgsException { 
    char elementId = element.charAt(0);
    String elementTail = element.substring(1); 
    validateSchemaElementId(elementId);
    if (elementTail.length() == 0)
      marshalers.put(elementId, new BooleanArgumentMarshaler());
    else if (elementTail.equals("*")) 
      marshalers.put(elementId, new StringArgumentMarshaler());
    else if (elementTail.equals("#"))
      marshalers.put(elementId, new IntegerArgumentMarshaler());
    else if (elementTail.equals("##")) 
      marshalers.put(elementId, new DoubleArgumentMarshaler());
    else
      throw new ArgsException(ArgsException.ErrorCode.INVALID_FORMAT, elementId, elementTail);
      
  private void validateSchemaElementId(char elementId) throws ArgsException { 
    if (!Character.isLetter(elementId)) {
      throw new ArgsException(ArgsException.ErrorCode.INVALID_ARGUMENT_NAME, elementId, null);
    } 
  }
  
  private void parseArguments() throws ArgsException {
    for (currentArgument = argsList.iterator(); currentArgument.hasNext();) {
      String arg = currentArgument.next();
      parseArgument(arg); 
    }
  }
  
  private void parseArgument(String arg) throws ArgsException { 
    if (arg.startsWith("-"))
      parseElements(arg); 
  }
  
  private void parseElements(String arg) throws ArgsException { 
    for (int i = 1; i < arg.length(); i++)
      parseElement(arg.charAt(i)); 
  }
  
  private void parseElement(char argChar) throws ArgsException { 
    if (setArgument(argChar))
      argsFound.add(argChar); 
    else 
      throw new ArgsException(ArgsException.ErrorCode.UNEXPECTED_ARGUMENT, argChar, null);
  } 
  
  private boolean setArgument(char argChar) throws ArgsException { 
    ArgumentMarshaler m = marshalers.get(argChar);
    if (m == null)
      return false; 
    try {
      m.set(currentArgument);
      return true;
    } catch (ArgsException e) {
      e.setErrorArgumentId(argChar);
      throw e; 
    }
  }
  
  public int cardinality() { 
    return argsFound.size();
  }
  
  public String usage() { 
    if (schema.length() > 0)
      return "-[" + schema + "]"; 
    else
      return ""; 
  }
  
  public boolean getBoolean(char arg) { 
    ArgumentMarshaler am = marshalers.get(arg); 
    boolean b = false;
    try {
      b = am != null && (Boolean) am.get(); 
    } catch (ClassCastException e) {
      b = false; 
    }
    return b; 
  }
  
  public String getString(char arg) { 
    ArgumentMarshaler am = marshalers.get(arg); 
    try {
      return am == null ? "" : (String) am.get(); 
    } catch (ClassCastException e) {
      return ""; 
    }
  }
  
  public int getInt(char arg) { 
    ArgumentMarshaler am = marshalers.get(arg); 
    try {
      return am == null ? 0 : (Integer) am.get(); 
    } catch (Exception e) {
      return 0; 
    }
  }
  
  public double getDouble(char arg) { 
    ArgumentMarshaler am = marshalers.get(arg); 
    try {
      return am == null ? 0 : (Double) am.get(); 
    } catch (Exception e) {
      return 0.0; 
    }
  }
  
  public boolean has(char arg) { 
    return argsFound.contains(arg);
  } 
}
```

- Args í´ë˜ìŠ¤ì—ì„œ ì½”ë“œ ì¤‘ë³µì„ ìµœì†Œí™”í•˜ê³ , ìƒë‹¹í•œ ì½”ë“œë¥¼ Args í´ë˜ìŠ¤ì—ì„œ ArgsException í´ë˜ìŠ¤ë¡œ ì˜®ê²¼ë‹¤. 
  - ë©‹ì§€ë‹¤. ë˜í•œ ArgumentMarshaler í´ë˜ìŠ¤ë¥¼ í†µí•´ ì—¬ëŸ¬ ì¸ìˆ˜ì— ëŒ€í•œ ì¶”í›„ í™•ì¥ì„±ì„ ê¾€í–ˆë‹¤.
  - ë”ìš± ë©‹ì§€ë‹¤!

- ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„ëŠ” ë¶„í• ë§Œ ì˜í•´ë„ í’ˆì§ˆì´ í¬ê²Œ ë†’ì•„ì§„ë‹¤. 
  - ì ì ˆí•œ ì¥ì†Œë¥¼ ë§Œë“¤ì–´ ì½”ë“œë§Œ ë¶„ë¦¬í•´ë„ ì„¤ê³„ê°€ ì¢‹ì•„ì§„ë‹¤. ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ë©´ ì½”ë“œë¥¼ ì´í•´í•˜ê³  ë³´ìˆ˜í•˜ê¸° í›¨ì”¬ ë” ì‰¬ì›Œì§„ë‹¤.

- íŠ¹ë³„íˆ ëˆˆì—¬ê²¨ë³¼ ì½”ë“œëŠ” ArgsExceptionì˜ errorMessage ë©”ì„œë“œë‹¤. (Args í´ë˜ìŠ¤ì— ì†í–ˆë˜) 
  - ì´ ë©”ì„œë“œëŠ” ëª…ë°±íˆ SRP(Single Responsibility Principle) ìœ„ë°˜ì´ì—ˆë‹¤. 
  - Args í´ë˜ìŠ¤ê°€ ì˜¤ë¥˜ ë©”ì„œì§€ í˜•ì‹ê¹Œì§€ ì±…ì„ì¡Œê¸° ë•Œë¬¸ì´ë‹¤.
  - ì´ í´ë˜ìŠ¤ëŠ” ì¸ìˆ˜ë¥¼ ì²˜ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ì§€ ì˜¤ë¥˜ ë©”ì‹œì§€ ê´€ë ¨ì„ ì²˜ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤. 
  - í•˜ì§€ë§Œ ê·¸ë ‡ë‹¤ê³  ArgsException í´ë˜ìŠ¤ê°€ ì˜¤ë¥˜ ë©”ì‹œì§€ í˜•ì‹ì„ ì²˜ë¦¬í•´ì•¼ ì˜³ì„ê¹Œ?

- ì†”ì§í•˜ê²Œ ë§í•´, ì´ê²ƒì€ ì ˆì¶©ì•ˆì´ë‹¤.
  - ArgsExceptionì—ê²Œ ë§¡ê²¨ì„œëŠ” ì•ˆ ëœë‹¤ê³  ìƒê°í•˜ëŠ” ë…ìë¼ë©´ ìƒˆë¡œìš´ í´ë˜ìŠ¤ê°€ í•„ìš”í•˜ë‹¤. í•˜ì§€ë§Œ ë¯¸ë¦¬ ê¹”ë”í•˜ê²Œ ë§Œë“¤ì–´ì§„ ì˜¤ë¥˜ ë©”ì‹œì§€ë¡œ ì–»ëŠ” ì¥ì ì€ ë¬´ì‹œí•˜ê¸° ì–´ë µë‹¤. \

- ì²˜ìŒì— ì†Œê°œí–ˆë˜ ìµœì¢… ì½”ë“œì— ê±°ì˜ ë„ë‹¬í–ˆë‹¤ëŠ” ëŠë‚Œì´ ë“ ë‹¤. ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” ì—¬ëŸ¬ë¶„ì—ê²Œ ë‚¨ê¸´ë‹¤.

## ê²°ë¡ 
- ê·¸ì € ëŒì•„ê°€ëŠ” ì½”ë“œë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•˜ë‹¤. 
  - ëŒì•„ê°€ëŠ” ì½”ë“œê°€ ì‹¬í•˜ê²Œ ë§ê°€ì§€ëŠ” ì‚¬ë¡€ëŠ” í”í•˜ë‹¤. 
  - ë‹¨ìˆœíˆ ëŒì•„ê°€ëŠ” ì½”ë“œì— ë§Œì¡±í•˜ëŠ” í”„ë¡œê·¸ë˜ë¨¸ëŠ” ì „ë¬¸ê°€ ì •ì‹ ì´ ë¶€ì¡±í•˜ë‹¤. 
  - ì„¤ê³„ì™€ êµ¬ì¡°ë¥¼ ê°œì„ í•  ì‹œê°„ì´ ì—†ë‹¤ê³  ë³€ê²½í• ì§€ ëª¨ë¥´ì§€ë§Œ ë‚˜ë¡œì„œëŠ” ë™ì˜í•˜ê¸° ì–´ë µë‹¤. 
  - ë‚˜ìœ ì½”ë“œë³´ë‹¤ ë” ì˜¤ë«ë™ì•ˆ ë” ì‹¬ê°í•˜ê²Œ ê°œë°œ í”„ë¡œì íŠ¸ì— ì•…ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìš”ì¸ë„ ì—†ë‹¤.
  - ë‚˜ìœ ì¼ì •ì€ ë‹¤ì‹œ ì§œë©´ ëœë‹¤. ë‚˜ìœ ìš”êµ¬ì‚¬í•­ì€ ë‹¤ì‹œ ì •ì˜í•˜ë©´ ëœë‹¤. 
  - ë‚˜ìœ íŒ€ ì—­í•™ì€ ë³µêµ¬í•˜ë©´ ëœë‹¤. 
  - í•˜ì§€ë§Œ ë‚˜ìœ ì½”ë“œëŠ” ì©ì–´ ë¬¸ë“œëŸ¬ì§„ë‹¤.
  - ì ì  ë¬´ê²Œê°€ ëŠ˜ì–´ë‚˜ íŒ€ì˜ ë°œëª©ì„ ì¡ëŠ”ë‹¤. 
  - ì†ë„ê°€ ì ì  ëŠë ¤ì§€ë‹¤ ëª»í•´ ê¸°ì–´ê°€ëŠ” íŒ€ë„ ë§ì´ ë´¤ë‹¤. 
  - ë„ˆë¬´ ì„œë‘ë¥´ë‹¤ê°€ ì´í›„ë¡œ ì˜ì›íˆ ìì‹ ë“¤ì˜ ìš´ëª…ì„ ì§€ë°°í•  ì•…ì„± ì½”ë“œë¼ëŠ” êµ´ë ˆë¥¼ ì§Šì–´ì§„ë‹¤. 

- ë¬¼ë¡  ë‚˜ìœ ì½”ë“œë„ ê¹¨ë—í•œ ì½”ë“œë¡œ ê°œì„ í•  ìˆ˜ ìˆë‹¤. 
  - í•˜ì§€ë§Œ ë¹„ìš©ì´ ì—„ì²­ë‚˜ê²Œ ë§ì´ ë“ ë‹¤. 
  - ì½”ë“œê°€ ì©ì–´ê°€ë©° ëª¨ë“ˆì€ ì„œë¡œì„œë¡œ ì–½íˆê³ ì„¤ì¼œ ë’¤ì—‰í‚¤ê³  ìˆ¨ê²¨ì§„ ì˜ì¡´ì„±ì´ ìˆ˜ë„ ì—†ì´ ìƒê¸´ë‹¤. 
  - ì˜¤ë˜ëœ ì˜ì¡´ì„±ì„ ì°¾ì•„ë‚´ ê¹¨ë ¤ë©´ ìƒë‹¹í•œ ì‹œê°„ê³¼ ì¸ë‚´ì‹¬ì´ í•„ìš”í•˜ë‹¤. 
  - ë°˜ë©´ ì²˜ìŒë¶€í„° ì½”ë“œë¥¼ ê¹¨ë—í•˜ê²Œ ìœ ì§€í•˜ê¸°ë€ ìƒëŒ€ì ìœ¼ë¡œ ì‰½ë‹¤. 
  - ì•„ì¹¨ì— ì—‰ë§ìœ¼ë¡œ ë§Œë“  ì½”ë“œë¥¼ ì˜¤í›„ì— ì •ë¦¬í•˜ê¸°ëŠ” ì–´ë µì§€ ì•Šë‹¤.
  - ë”ìš±ì´ 5ë¶„ ì „ì— ì—‰ë§ìœ¼ë¡œ ë§Œë“  ì½”ë“œëŠ” ì§€ê¸ˆ ë‹¹ì¥ ì •ë¦¬í•˜ê¸° ì•„ì£¼ ì‰½ë‹¤. 
 
- ê·¸ëŸ¬ë¯€ë¡œ ì½”ë“œëŠ” ì–¸ì œë‚˜ ìµœëŒ€í•œ ê¹”ë”í•˜ê³  ë‹¨ìˆœí•˜ê²Œ ì •ë¦¬í•˜ì. ì ˆëŒ€ë¡œ ì©ì–´ê°€ê²Œ ë°©ì¹˜í•˜ë©´ ì•ˆ ëœë‹¤. 